{"version":3,"sources":["webpack://addons-linter/./src/utils.js","webpack://addons-linter/external \"url\"","webpack://addons-linter/external \"upath\"","webpack://addons-linter/external \"jed\"","webpack://addons-linter/external \"semver\"","webpack://addons-linter/external \"common-tags\"","webpack://addons-linter/external \"os-locale\"","webpack://addons-linter/./src/logger.js","webpack://addons-linter/external \"pino\"","webpack://addons-linter/./src/const.js","webpack://addons-linter/./src/messages/javascript.js","webpack://addons-linter/external \"@mdn/browser-compat-data\"","webpack://addons-linter/./src/schema/browser-apis.js","webpack://addons-linter/./src/schema/imported/index.js","webpack://addons-linter/webpack/bootstrap","webpack://addons-linter/./src/rules/javascript/webextension-api-compat-android.js"],"names":["SOURCE_MAP_RE","RegExp","normalizePath","iconPath","pathname","URL","upath","toUnix","decodeURIComponent","slice","getRootExpression","node","root","callee","type","parent","object","getNodeReference","context","variables","getScope","scopeVar","i","length","variable","name","defs","body","occurances","lastAssignment","Array","forEach","occurance","declarations","init","expression","right","getVariable","result","getLocale","osLocale","sync","getI18Data","locale","i18ndata","nodeRequire","localesRoot","err","log","info","buildI18nObject","i18nData","_jed","Jed","jed","_","str","gettext","sprintf","fmt","args","i18n","checkMinNodeVersion","minVersion","_process","process","semver","gte","version","Error","getPackageTypeAsString","numericPackageType","packageKeys","Object","keys","PACKAGE_TYPES","packageType","parseInt","ignorePrivateFunctions","list","filteredList","functionName","startsWith","ensureFilenameExists","filename","isLocalUrl","urlInput","parsedUrl","url","parse","protocol","path","LOCAL_PROTOCOLS","includes","apiToMessage","string","replace","toUpperCase","substr","isBrowserNamespace","parseCspPolicy","policy","toLowerCase","parsedPolicy","directives","split","directive","trim","tokens","getLineAndColumnFromMatch","match","matchedLines","input","index","matchedColumn","matchedLine","couldBeMinifiedCode","code","test","sampleSize","indentCountThreshold","hugeLinesLength","hugeLinesThreshold","lineEndIndex","lineStartIndex","lines","indentCount","hugeLinesCount","normalizedCode","indexOf","currentLine","firefoxStrictMinVersion","manifestJson","applications","gecko","strict_min_version","basicCompatVersionComparison","versionAdded","asNumber","Number","isNaN","firstStableVersion","supportInfo","supportInfoArray","isArray","reduce","supportEntry","prototype","hasOwnProperty","call","version_added","isCompatible","bcd","application","steps","api","webextensions","step","__compat","support","createCompatibilityRule","message","hasBrowserApi","settings","addonMetadata","firefoxMinVersion","MemberExpression","computed","namespace","property","report","messageFormat","createLogger","level","env","LOG_LEVEL","stdout","ESLINT_ERROR","ESLINT_WARNING","DISABLE_ALLOWED_ESCAPERS","escape","taggedTemplates","methods","EXTERNAL_RULE_MAPPING","allowIndirect","ESLINT_RULE_MAPPING","VALIDATION_ERROR","VALIDATION_NOTICE","VALIDATION_WARNING","ESLINT_TYPES","MESSAGE_TYPES","PACKAGE_ANY","PACKAGE_EXTENSION","PACKAGE_THEME","PACKAGE_DICTIONARY","PACKAGE_LANGPACK","PACKAGE_SEARCHPROV","PACKAGE_MULTI","PACKAGE_SUBPACKAGE","MANIFEST_JSON","VALID_MANIFEST_VERSION","MAX_FILE_SIZE_TO_PARSE_MB","HIDDEN_FILE_REGEX","FLAGGED_FILE_REGEX","ALREADY_SIGNED_REGEX","RESERVED_FILENAMES","FLAGGED_FILE_EXTENSIONS","IMAGE_FILE_EXTENSIONS","FILE_EXTENSIONS_TO_MIME","svg","gif","jpg","jpeg","png","webp","STATIC_THEME_IMAGE_MIMES","Set","values","DEPRECATED_MANIFEST_PROPERTIES","DEPRECATED_JAVASCRIPT_APIS","FLAGGED_FILE_MAGIC_NUMBERS","TEMPORARY_APIS","CSP_KEYWORD_RE","join","MESSAGES_JSON","LOCALES_DIRECTORY","MESSAGE_PLACEHOLDER_REGEXP","ZIP_LIB_CORRUPT_FILE_ERROR","RESTRICTED_HOMEPAGE_URLS","JS_SYNTAX_ERROR","description","EVENT_LISTENER_FOURTH","CONTENT_SCRIPT_NOT_FOUND","legacyCode","CONTENT_SCRIPT_EMPTY","_nonLiteralUri","method","_methodPassedRemoteUri","OPENDIALOG_REMOTE_URI","OPENDIALOG_NONLIT_URI","DANGEROUS_EVAL","NO_IMPLIED_EVAL","UNEXPECTED_GLOGAL_ARG","NO_DOCUMENT_WRITE","BANNED_LIBRARY","UNADVISED_LIBRARY","KNOWN_LIBRARY","UNSAFE_DYNAMIC_VARIABLE_ASSIGNMENT","UNSUPPORTED_API","DEPRECATED_API","DEPRECATED_CHROME_API","temporaryAPI","STORAGE_SYNC","IDENTITY_GETREDIRECTURL","STORAGE_MANAGED","RUNTIME_ONMESSAGEEXTERNAL","RUNTIME_ONCONNECTEXTERNAL","INCOMPATIBLE_API","ANDROID_INCOMPATIBLE_API","ESLINT_OVERWRITE_MESSAGE","schemaArrayNames","schemaObjectNames","schemas","schemaList","all","current","id","getObjectProperty","schema","schemaProperty","getArrayProperty","namespaceProperties","schemaItem","isTemporaryApi","isDeprecatedApi","deprecated","undefined","unsupported","activityLog","alarms","bookmarks","browserAction","browserSettings","browsingData","captivePortal","chrome_settings_overrides","clipboard","commands","contentScripts","contextualIdentities","cookies","devtools","dns","downloads","events","experiments","extension","extension_protocol_handlers","extensionTypes","find","geckoProfiler","history","identity","idle","management","menus","native_manifest","networkStatus","normandyAddonStudy","notifications","omnibox","pageAction","permissions","pkcs11","privacy","proxy","runtime","search","sessions","sidebarAction","storage","tabs","telemetry","theme","topSites","types","url_overrides","urlbar","userScripts","webNavigation","webRequest","windows","contextMenus","rule","create"],"mappings":"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","file":"rules/javascript/webextension-api-compat-android.js","sourcesContent":["import url from 'url';\n\nimport upath from 'upath';\nimport Jed from 'jed';\nimport semver from 'semver';\nimport { oneLine } from 'common-tags';\nimport osLocale from 'os-locale';\n\nimport log from 'logger';\nimport { PACKAGE_TYPES, LOCAL_PROTOCOLS } from 'const';\n\n/* global nodeRequire, localesRoot */\n\nconst SOURCE_MAP_RE = new RegExp(/\\/\\/[#@]\\s(source(?:Mapping)?URL)=\\s*(\\S+)/);\n\nexport function normalizePath(iconPath) {\n  // Convert the icon path to a URL so we can strip any fragments and resolve\n  // . and .. automatically. We need an absolute URL to use as a base so we're\n  // using https://example.com/.\n  const { pathname } = new URL(iconPath, 'https://example.com/');\n\n  // Convert filename to unix path separator (as the ones stored\n  // into the scanned files map).\n  return upath.toUnix(decodeURIComponent(pathname).slice(1));\n}\n\n/*\n * Takes an AST node and returns the root property.\n *\n * example: foo().bar.baz() will return the AST node for foo.\n */\nexport function getRootExpression(node) {\n  let root = node.callee;\n\n  // If we encounter a member, grab the parent\n  if (node.callee.type === 'MemberExpression') {\n    let parent = node.callee.object;\n    while (parent.type !== 'Identifier') {\n      if (parent.callee.type === 'MemberExpression') {\n        parent = parent.callee.object;\n      } else {\n        parent = parent.callee;\n      }\n    }\n    root = parent;\n  }\n\n  return root;\n}\n\n/*\n * Returns the name of the reference node passed.\n *\n * example: var foo = document;\n *  The node for foo will return 'document'\n */\nexport function getNodeReference(context, node) {\n  const { variables } = context.getScope();\n  let scopeVar;\n\n  // Just return the value if the node passed in is a reference to a literal.\n  if (typeof node === 'undefined' || node.type === 'Literal') {\n    return node;\n  }\n\n  // Finds variable reference in current scope.\n  for (let i = 0; i < variables.length; i++) {\n    const variable = variables[i];\n    if (variable.name === node.name) {\n      scopeVar = variable;\n      break;\n    }\n  }\n\n  if (\n    scopeVar &&\n    scopeVar.defs &&\n    scopeVar.defs[0] &&\n    scopeVar.defs[0].parent &&\n    scopeVar.defs[0].parent.parent &&\n    scopeVar.defs[0].parent.parent.body\n  ) {\n    // This represents all occurrences of the variable\n    const occurances = scopeVar.defs[0].parent.parent.body;\n    let lastAssignment;\n\n    if (occurances instanceof Array) {\n      occurances.forEach((occurance) => {\n        if (\n          occurance.type === 'VariableDeclaration' &&\n          occurance.declarations[0].init !== null\n        ) {\n          // Get what the name of what it was assigned to or the raw\n          // value depending on the initalization\n          lastAssignment = occurance.declarations[0].init;\n        } else if (\n          occurance.type === 'ExpressionStatement' &&\n          occurance.expression.type === 'AssignmentExpression'\n        ) {\n          // Get the right hand side of the assignment\n          lastAssignment = occurance.expression.right;\n        }\n      });\n    }\n\n    // Return the name of the first definition of the variable which\n    // corresponds to the node passed in.\n    if (lastAssignment) {\n      return lastAssignment;\n    }\n  }\n\n  // If that variable doesn't exist in scope, then just return the node's\n  // name.\n  return node;\n}\n\n/*\n * Get a variable from a eslint context object if it exists, otherwise\n * undefined.\n */\nexport function getVariable(context, name) {\n  const { variables } = context.getScope();\n  let result;\n  variables.forEach((variable) => {\n    if (\n      variable.name === name &&\n      variable.defs &&\n      variable.defs[0] &&\n      variable.defs[0].name &&\n      variable.defs[0].name.parent\n    ) {\n      result = variable.defs[0].name.parent.init;\n    }\n  });\n  return result;\n}\n\nexport function getLocale() {\n  return osLocale.sync();\n}\n\nexport function getI18Data(locale) {\n  let i18ndata = {};\n  try {\n    // eslint-disable-next-line global-require, import/no-dynamic-require\n    i18ndata = nodeRequire(`${localesRoot}/${locale}/messages.js`);\n  } catch (err) {\n    log.info('Initialize locales using extract-locales command');\n  }\n\n  return i18ndata;\n}\n\n/*\n * Gettext utils. Used for translating strings.\n */\nexport function buildI18nObject(i18nData) {\n  const _jed = new Jed(i18nData);\n\n  return {\n    jed: _jed,\n    getI18Data,\n    _: (str) => {\n      return _jed.gettext(str);\n    },\n    gettext: (str) => {\n      return _jed.gettext(str);\n    },\n    sprintf: (fmt, args) => {\n      return _jed.sprintf(fmt, args);\n    },\n  };\n}\n\nexport const i18n = buildI18nObject(getI18Data(getLocale()));\n\n/*\n * Check the minimum node version is met\n */\nexport async function checkMinNodeVersion(minVersion, _process = process) {\n  // eslint-disable-next-line no-param-reassign\n  minVersion = minVersion || '0.12.0';\n  if (!semver.gte(_process.version, minVersion)) {\n    throw new Error(oneLine`Node version must be ${minVersion} or\n                    greater. You are using ${_process.version}.`);\n  }\n}\n\nexport function getPackageTypeAsString(numericPackageType) {\n  const packageKeys = Object.keys(PACKAGE_TYPES);\n  for (let i = 0; i < packageKeys.length; i++) {\n    const packageType = packageKeys[i];\n    if (parseInt(numericPackageType, 10) === PACKAGE_TYPES[packageType]) {\n      return packageType;\n    }\n  }\n  throw new Error(`Invalid package type constant \"${numericPackageType}\"`);\n}\n\n/*\n * Looks through all exported functions and returns only\n * \"public\" *functions* that aren't prefixed with an _\n *\n * Used for ignoring private functions and constants in rules files.\n * Rules can have private functions we don't run; anything that\n * starts with an \"_\" shouldn't be returned.\n *\n * This exists because we export private functions in rule files\n * for testing.\n */\nexport function ignorePrivateFunctions(list) {\n  const filteredList = {};\n\n  Object.keys(list).forEach((functionName) => {\n    if (\n      functionName.startsWith('_') === false &&\n      typeof list[functionName] === 'function'\n    ) {\n      filteredList[functionName] = list[functionName];\n    }\n  });\n\n  return filteredList;\n}\n\n/*\n * Check a filename to make sure it's valid; used by scanners so we never\n * accept new scanners that don't specify which file they're referencing.\n */\nexport function ensureFilenameExists(filename) {\n  if (typeof filename !== 'string' || filename.length < 1) {\n    throw new Error('Filename is required');\n  }\n}\n\nexport function isLocalUrl(urlInput) {\n  const parsedUrl = url.parse(urlInput);\n  const { protocol, path } = parsedUrl;\n\n  // Check protocol is chrome: or resource: if set.\n  // Details on the chrome protocol are here: https://goo.gl/W52T0Q\n  // Details on resource protocol are here: https://goo.gl/HHqeJA\n  if (protocol && !LOCAL_PROTOCOLS.includes(protocol)) {\n    return false;\n  }\n  // Disallow protocol-free remote urls.\n  if (path.startsWith('//')) {\n    return false;\n  }\n  return true;\n}\n\nexport function apiToMessage(string) {\n  return string\n    .replace(/^extension/, 'ext')\n    .replace(/\\./g, '_')\n    .toUpperCase()\n    .substr(0, 25);\n}\n\nexport function isBrowserNamespace(string) {\n  return ['browser', 'chrome'].includes(string);\n}\n\nexport function parseCspPolicy(policy) {\n  if (!policy) {\n    return {};\n  }\n\n  // eslint-disable-next-line no-param-reassign\n  policy = policy.toLowerCase();\n\n  const parsedPolicy = {};\n  const directives = policy.split(';');\n\n  directives.forEach((directive) => {\n    // eslint-disable-next-line no-param-reassign\n    directive = directive.trim();\n    const tokens = directive.split(/\\s+/);\n\n    const name = tokens[0];\n\n    if (name) {\n      parsedPolicy[name] = tokens.slice(1, tokens.length);\n    }\n  });\n\n  return parsedPolicy;\n}\n\nexport function getLineAndColumnFromMatch(match) {\n  const matchedLines = match.input.substr(0, match.index).split('\\n');\n  const matchedColumn = matchedLines.slice(-1)[0].length + 1;\n  const matchedLine = matchedLines.length;\n\n  return { matchedLine, matchedColumn };\n}\n\n/**\n * Determines if the source text is minified.\n * Using the percentage no. of the indented lines from a sample set of lines\n * to determine if the js file is minified.\n * Inspired by code for the Firefox Developer Toolbar.\n */\nexport function couldBeMinifiedCode(code) {\n  // Fast exit if `code` is empty. Could happen in tests, but also in real\n  // files.\n  if (!code) {\n    return false;\n  }\n\n  // If there's a source map reference it's very certainly minified code.\n  if (SOURCE_MAP_RE.test(code)) {\n    return true;\n  }\n\n  // Number of lines to look at, taken from the head of the code.\n  const sampleSize = 30;\n\n  // Threshold in percent of indented lines to mark a file as not\n  // minified.\n  const indentCountThreshold = 20; // percentage\n\n  // Length of a line that looks suspicious of being minified\n  const hugeLinesLength = 500;\n\n  // Number of huge lines to also mark a file as potentially minified\n  // Hint: Minified AngularJS has 12 lines, jQuery 4\n  const hugeLinesThreshold = 4;\n\n  let lineEndIndex = 0;\n  let lineStartIndex = 0;\n  let lines = 1;\n  let indentCount = 0;\n  let hugeLinesCount = 0;\n\n  // Strip comments.\n  const normalizedCode = code.replace(/\\/\\*[\\S\\s]*?\\*\\/|\\/\\/.+/g, '');\n\n  while (lines < sampleSize) {\n    lineEndIndex = normalizedCode.indexOf('\\n', lineStartIndex);\n\n    if (lineEndIndex === -1) {\n      break;\n    }\n\n    const currentLine = normalizedCode.slice(lineStartIndex, lineEndIndex);\n\n    if (/^\\s+/.test(currentLine)) {\n      indentCount++;\n    }\n\n    if (currentLine.length >= hugeLinesLength) {\n      hugeLinesCount++;\n    }\n\n    lineStartIndex = lineEndIndex + 1;\n    lines++;\n  }\n\n  return (\n    (indentCount / lines) * 100 < indentCountThreshold ||\n    hugeLinesCount > hugeLinesThreshold\n  );\n}\n\nexport function firefoxStrictMinVersion(manifestJson) {\n  if (\n    manifestJson.applications &&\n    manifestJson.applications.gecko &&\n    manifestJson.applications.gecko.strict_min_version\n  ) {\n    return parseInt(\n      manifestJson.applications.gecko.strict_min_version.split('.')[0],\n      10\n    );\n  }\n  return null;\n}\n\nexport function basicCompatVersionComparison(versionAdded, minVersion) {\n  const asNumber = parseInt(versionAdded, 10);\n  return !Number.isNaN(asNumber) && asNumber > minVersion;\n}\n\n/**\n * @param {*} supportInfo - bcd support info of a feature\n * @returns {string|boolean} The first version number to support the feature\n *          or a boolean indicating if the feature is supported at all. We do\n *          not consider any holes in the supported versions, only the first\n *          stable version is taken into account.\n */\nexport function firstStableVersion(supportInfo) {\n  let supportInfoArray = supportInfo;\n  if (!Array.isArray(supportInfo)) {\n    supportInfoArray = [supportInfo];\n  }\n  return supportInfoArray.reduce((versionAdded, supportEntry) => {\n    if (\n      !Object.prototype.hasOwnProperty.call(supportEntry, 'flags') &&\n      (!versionAdded ||\n        (supportEntry.version_added &&\n          !basicCompatVersionComparison(\n            supportEntry.version_added,\n            parseInt(versionAdded, 10)\n          )))\n    ) {\n      return supportEntry.version_added;\n    }\n    return versionAdded;\n  }, false);\n}\n\nexport function isCompatible(bcd, path, minVersion, application) {\n  const steps = path.split('.');\n  let { api } = bcd.webextensions;\n  for (const step of steps) {\n    if (Object.prototype.hasOwnProperty.call(api, step)) {\n      api = api[step];\n    } else {\n      break;\n    }\n  }\n  // API namespace may be undocumented or not implemented, ignore in that case.\n  if (api.__compat) {\n    const supportInfo = api.__compat.support[application];\n    const versionAdded = firstStableVersion(supportInfo);\n    return !basicCompatVersionComparison(versionAdded, minVersion);\n  }\n  return true;\n}\n\nexport function createCompatibilityRule(\n  application,\n  message,\n  context,\n  bcd,\n  hasBrowserApi\n) {\n  const minVersion =\n    context.settings.addonMetadata &&\n    firefoxStrictMinVersion({\n      applications: {\n        gecko: {\n          strict_min_version: context.settings.addonMetadata.firefoxMinVersion,\n        },\n      },\n    });\n  if (minVersion) {\n    return {\n      MemberExpression(node) {\n        if (\n          !node.computed &&\n          node.object.object &&\n          isBrowserNamespace(node.object.object.name)\n        ) {\n          const namespace = node.object.property.name;\n          const property = node.property.name;\n          const api = `${namespace}.${property}`;\n          if (\n            hasBrowserApi(namespace, property) &&\n            !isCompatible(bcd, api, minVersion, application)\n          ) {\n            context.report(node, message.messageFormat, {\n              api,\n              minVersion: context.settings.addonMetadata.firefoxMinVersion,\n            });\n          }\n        }\n      },\n    };\n  }\n  return {};\n}\n","module.exports = require(\"url\");;","module.exports = require(\"upath\");;","module.exports = require(\"jed\");;","module.exports = require(\"semver\");;","module.exports = require(\"common-tags\");;","module.exports = require(\"os-locale\");;","import pino from 'pino';\n\nexport function createLogger(_process = process) {\n  const level = _process.env.LOG_LEVEL || 'fatal';\n  return pino(\n    {\n      name: 'AddonLinterJS',\n      level,\n    },\n    process.stdout\n  );\n}\n\nexport default createLogger();\n","module.exports = require(\"pino\");;","export const ESLINT_ERROR = 2;\nexport const ESLINT_WARNING = 1;\n\n// Disable escapers (Sanitizer.escapeHTML, escapeHTML)\n// and unwrappers (Sanitizer.unwrapSafeHTML, unwrapSafeHTML)\n// which are allowed by default by this plugin.\nconst DISABLE_ALLOWED_ESCAPERS = {\n  escape: { taggedTemplates: [], methods: [] },\n};\n\n// 3rd party / eslint-internal rules\nexport const EXTERNAL_RULE_MAPPING = {\n  'no-eval': [ESLINT_WARNING, { allowIndirect: false }],\n  'no-implied-eval': ESLINT_WARNING,\n  'no-new-func': ESLINT_WARNING,\n  'no-unsanitized/method': [ESLINT_WARNING, DISABLE_ALLOWED_ESCAPERS],\n  'no-unsanitized/property': [ESLINT_WARNING, DISABLE_ALLOWED_ESCAPERS],\n};\n\nexport const ESLINT_RULE_MAPPING = {\n  'deprecated-entities': ESLINT_WARNING,\n  'event-listener-fourth': ESLINT_WARNING,\n  'global-require-arg': ESLINT_WARNING,\n  'opendialog-nonlit-uri': ESLINT_WARNING,\n  'opendialog-remote-uri': ESLINT_WARNING,\n  'webextension-api': ESLINT_WARNING,\n  'webextension-deprecated-api': ESLINT_WARNING,\n  'webextension-unsupported-api': ESLINT_WARNING,\n  'content-scripts-file-absent': ESLINT_ERROR,\n  'webextension-api-compat': ESLINT_WARNING,\n  'webextension-api-compat-android': ESLINT_WARNING,\n  ...EXTERNAL_RULE_MAPPING,\n};\n\nexport const VALIDATION_ERROR = 'error';\nexport const VALIDATION_NOTICE = 'notice';\nexport const VALIDATION_WARNING = 'warning';\n\nexport const ESLINT_TYPES = {\n  0: VALIDATION_NOTICE,\n  1: VALIDATION_WARNING,\n  2: VALIDATION_ERROR,\n};\n\nexport const MESSAGE_TYPES = [\n  VALIDATION_ERROR,\n  VALIDATION_NOTICE,\n  VALIDATION_WARNING,\n];\n\n// Package type constants.\nexport const PACKAGE_ANY = 0;\nexport const PACKAGE_EXTENSION = 1;\nexport const PACKAGE_THEME = 2;\nexport const PACKAGE_DICTIONARY = 3;\nexport const PACKAGE_LANGPACK = 4;\nexport const PACKAGE_SEARCHPROV = 5;\nexport const PACKAGE_MULTI = 1; // A multi extension is an extension\nexport const PACKAGE_SUBPACKAGE = 7;\n\nexport const PACKAGE_TYPES = {\n  PACKAGE_ANY,\n  PACKAGE_EXTENSION,\n  PACKAGE_THEME,\n  PACKAGE_DICTIONARY,\n  PACKAGE_LANGPACK,\n  PACKAGE_SEARCHPROV,\n  PACKAGE_MULTI,\n  PACKAGE_SUBPACKAGE,\n};\n\nexport const LOCAL_PROTOCOLS = ['chrome:', 'resource:'];\n\nexport const MANIFEST_JSON = 'manifest.json';\n\nexport const VALID_MANIFEST_VERSION = 2;\n\n// This is the limit in megabytes of a file we will parse (eg. CSS, JS, etc.)\n// A singular CSS/JS file over 4MB seems bad and may actually be full of data\n// best stored in JSON/some other data format rather than code.\n// https://github.com/mozilla/addons-linter/issues/730\n// We increased this limit from 2MB to 4MB as per:\n// https://github.com/mozilla/addons/issues/181\n//\n// We should be careful about increasing this any further.\nexport const MAX_FILE_SIZE_TO_PARSE_MB = 4;\n\nexport const HIDDEN_FILE_REGEX = /^__MACOSX\\//;\nexport const FLAGGED_FILE_REGEX = /thumbs\\.db$|\\.DS_Store$|\\.orig$|\\.old$|~$/i;\nexport const ALREADY_SIGNED_REGEX = /^META-INF\\/manifest\\.mf/;\n\nexport const RESERVED_FILENAMES = ['mozilla-recommendation.json'];\n\nexport const FLAGGED_FILE_EXTENSIONS = [\n  '.class',\n  '.dll',\n  '.dylib',\n  '.exe',\n  '.jar',\n  '.sh',\n  '.so',\n  '.swf',\n];\n\nexport const IMAGE_FILE_EXTENSIONS = [\n  'jpg',\n  'jpeg',\n  'webp',\n  'gif',\n  'png',\n  'svg',\n];\n\nexport const FILE_EXTENSIONS_TO_MIME = {\n  svg: 'image/svg+xml',\n  gif: 'image/gif',\n  jpg: 'image/jpeg',\n  jpeg: 'image/jpeg',\n  png: 'image/png',\n  webp: 'image/webp',\n};\n\n// Unique list of mime types for the allowed static theme images.\nexport const STATIC_THEME_IMAGE_MIMES = [\n  ...new Set(Object.values(FILE_EXTENSIONS_TO_MIME)),\n];\n\n// Mapping of \"schema data paths\" of the deprecated properties that we\n// issue warnings for.\n// If the value is `null` we will be using the `deprecated` message\n// from the schema. Otherwise `code`, `message` and `description` will be taken\n// from the object provided.\n// Note that we have to use the constants name as we can't import\n// the message object here.\nexport const DEPRECATED_MANIFEST_PROPERTIES = {\n  '/theme/images/headerURL': 'MANIFEST_THEME_LWT_ALIAS',\n  '/theme/colors/accentcolor': 'MANIFEST_THEME_LWT_ALIAS',\n  '/theme/colors/textcolor': 'MANIFEST_THEME_LWT_ALIAS',\n};\n\n// Mapping of deprecated javascript apis.\n// If the value is `null` we will be using the `deprecated` message\n// from the schema. Otherwise `code`, `message` and `description` will be taken\n// from the object provided.\n// Note that we have to use the constants name as we can't import\n// the message object here.\nexport const DEPRECATED_JAVASCRIPT_APIS = {\n  // These APIs were already deprecated by Chrome and Firefox never\n  // supported them. We do still issue deprecation warnings for them.\n  'app.getDetails': 'DEPRECATED_CHROME_API',\n  'extension.onRequest': 'DEPRECATED_CHROME_API',\n  'extension.onRequestExternal': 'DEPRECATED_CHROME_API',\n  'extension.sendRequest': 'DEPRECATED_CHROME_API',\n  'tabs.getAllInWindow': 'DEPRECATED_CHROME_API',\n  'tabs.getSelected': 'DEPRECATED_CHROME_API',\n  'tabs.onActiveChanged': 'DEPRECATED_CHROME_API',\n  'tabs.onSelectionChanged': 'DEPRECATED_CHROME_API',\n  'tabs.sendRequest': 'DEPRECATED_CHROME_API',\n\n  // https://github.com/mozilla/addons-linter/issues/2556\n  'proxy.register': 'DEPRECATED_API',\n  'proxy.unregister': 'DEPRECATED_API',\n  'proxy.onProxyError': 'DEPRECATED_API',\n  'proxy.registerProxyScript': 'DEPRECATED_API',\n};\n\n// A list of magic numbers that we won't allow.\nexport const FLAGGED_FILE_MAGIC_NUMBERS = [\n  [0x4d, 0x5a], // EXE or DLL,\n  [0x5a, 0x4d], // Alternative EXE or DLL\n  [0x7f, 0x45, 0x4c, 0x46], // UNIX elf\n  [0x23, 0x21], // Shell script\n  [0xca, 0xfe, 0xba, 0xbe], // Java + Mach-O (dylib)\n  [0xca, 0xfe, 0xd0, 0x0d], // Java packed\n  [0x43, 0x57, 0x53], // Compressed SWF\n];\n\n// These are APIs that will cause problems when loaded temporarily\n// in about:debugging.\n// APIs listed here should be defined in https://mzl.la/31p4AMc\nexport const TEMPORARY_APIS = [\n  'identity.getRedirectURL',\n  'storage.sync',\n  'storage.managed',\n  'runtime.onMessageExternal',\n  'runtime.onConnectExternal',\n];\n\n// All valid CSP keywords that are options to keys like `default-src` and\n// `script-src`. Used in manifest.json parser for validation.\n// See https://mzl.la/2vwqbGU for more details and allowed options.\nexport const CSP_KEYWORD_RE = new RegExp(\n  [\n    '(self|none|unsafe-inline|strict-dynamic|unsafe-hashed-attributes)',\n    // Only match these keywords, anything else is forbidden\n    '(?!.)',\n    '|(sha(256|384|512)-|nonce-)',\n  ].join('')\n);\n\nexport const MESSAGES_JSON = 'messages.json';\nexport const LOCALES_DIRECTORY = '_locales';\n\n// This is a string, since it has to be matched globally on a message string.\n// This should match\n// https://searchfox.org/mozilla-central/rev/3abf6fa7e2a6d9a7bfb88796141b0f012e68c2db/toolkit/components/extensions/ExtensionCommon.jsm#1711\nexport const MESSAGE_PLACEHOLDER_REGEXP = '\\\\$([a-zA-Z0-9_@]+)\\\\$';\n\n// yauzl should trow error with this message in case of corrupt zip file\nexport const ZIP_LIB_CORRUPT_FILE_ERROR =\n  'end of central directory record signature not found';\n\n// URLs in this array are restricted from being used in the manifest.json \"homepage_url\" prperty\nexport const RESTRICTED_HOMEPAGE_URLS = [\n  'addons-dev.allizom.org',\n  'addons.mozilla.org',\n];\n","import { oneLine } from 'common-tags';\n\nimport { apiToMessage, i18n } from 'utils';\n\nexport const JS_SYNTAX_ERROR = {\n  code: 'JS_SYNTAX_ERROR',\n  message: i18n._('JavaScript syntax error'),\n  description: i18n._(oneLine`There is a JavaScript syntax error in your\n    code, which might be related to some experimental JavaScript features that\n    aren't an official part of the language specification and therefore not\n    supported yet. The validation cannot continue on this file.`),\n};\n\nexport const EVENT_LISTENER_FOURTH = {\n  code: 'EVENT_LISTENER_FOURTH',\n  message: i18n._('addEventListener` called with truthy fourth argument.'),\n  description: i18n._(oneLine`When called with a truthy forth argument,\n    listeners can be triggered potentially unsafely by untrusted code. This\n    requires careful review.`),\n};\n\nexport const CONTENT_SCRIPT_NOT_FOUND = {\n  code: 'CONTENT_SCRIPT_NOT_FOUND',\n  legacyCode: null,\n  message: i18n._('Content script file could not be found.'),\n  description: i18n._('Content script file could not be found'),\n};\n\nexport const CONTENT_SCRIPT_EMPTY = {\n  code: 'CONTENT_SCRIPT_EMPTY',\n  legacyCode: null,\n  message: i18n._('Content script file name should not be empty.'),\n  description: i18n._('Content script file name should not be empty'),\n};\n\nexport function _nonLiteralUri(method) {\n  return {\n    code: `${method}_NONLIT_URI`.toUpperCase(),\n    message: i18n._(`'${method}' called with a non-literal uri`),\n    description: i18n._(oneLine`Calling '${method}' with variable\n      parameters can result in potential security vulnerabilities if the\n      variable contains a remote URI. Consider using 'window.open' with\n      the 'chrome=no' flag.`),\n  };\n}\n\nexport function _methodPassedRemoteUri(method) {\n  return {\n    code: `${method}_REMOTE_URI`.toUpperCase(),\n    message: i18n._(`'${method}' called with non-local URI`),\n    description: i18n._(oneLine`Calling '${method}' with a non-local\n      URI will result in the dialog being opened with chrome privileges.`),\n  };\n}\n\nexport const OPENDIALOG_REMOTE_URI = _methodPassedRemoteUri('openDialog');\nexport const OPENDIALOG_NONLIT_URI = _nonLiteralUri('openDialog');\n\nexport const DANGEROUS_EVAL = {\n  code: 'DANGEROUS_EVAL',\n  message: null,\n  description: i18n._(oneLine`Evaluation of strings as code can lead to\n    security vulnerabilities and performance issues, even in the\n    most innocuous of circumstances. Please avoid using \\`eval\\` and the\n    \\`Function\\` constructor when at all possible.'`),\n};\n\nexport const NO_IMPLIED_EVAL = {\n  code: 'NO_IMPLIED_EVAL',\n  message: null,\n  description: i18n._(oneLine`setTimeout, setInterval and execScript\n    functions should be called only with function expressions as their\n    first argument`),\n};\n\nexport const UNEXPECTED_GLOGAL_ARG = {\n  code: 'UNEXPECTED_GLOGAL_ARG',\n  message: i18n._('Unexpected global passed as an argument'),\n  description: i18n._(oneLine`Passing a global as an argument\n    is not recommended. Please make this a var instead.`),\n};\n\nexport const NO_DOCUMENT_WRITE = {\n  code: 'NO_DOCUMENT_WRITE',\n  message: i18n._('Use of document.write strongly discouraged.'),\n  description: i18n._(oneLine`document.write will fail in many\n    circumstances when used in extensions, and has potentially severe security\n    repercussions when used improperly. Therefore, it should not be used.`),\n};\n\nexport const BANNED_LIBRARY = {\n  code: 'BANNED_LIBRARY',\n  message: i18n._('Banned 3rd-party JS library'),\n  description: i18n._(oneLine`Your add-on uses a JavaScript library we\n    consider unsafe. Read more: https://bit.ly/1TRIyZY`),\n};\n\nexport const UNADVISED_LIBRARY = {\n  code: 'UNADVISED_LIBRARY',\n  message: i18n._('Unadvised 3rd-party JS library'),\n  description: i18n._(oneLine`Your add-on uses a JavaScript library we do\n    not recommend. Read more: https://bit.ly/1TRIyZY`),\n};\n\nexport const KNOWN_LIBRARY = {\n  code: 'KNOWN_LIBRARY',\n  message: i18n._('Known JS library detected'),\n  description: i18n._(oneLine`JavaScript libraries are discouraged for\n    simple add-ons, but are generally accepted.`),\n};\n\nexport const UNSAFE_DYNAMIC_VARIABLE_ASSIGNMENT = {\n  code: 'UNSAFE_VAR_ASSIGNMENT',\n  // Uses original message from eslint\n  message: null,\n  description: i18n._(oneLine`Due to both security and performance\n    concerns, this may not be set using dynamic values which have\n    not been adequately sanitized. This can lead to security issues or fairly\n    serious performance degradation.`),\n};\n\nexport const UNSUPPORTED_API = {\n  code: 'UNSUPPORTED_API',\n  message: null,\n  messageFormat: i18n._('{{api}} is not supported'),\n  description: i18n._('This API has not been implemented by Firefox.'),\n};\n\nexport const DEPRECATED_API = {\n  code: 'DEPRECATED_API',\n  message: null,\n  messageFormat: i18n._('{{api}} is deprecated'),\n  description: i18n._('This API has been deprecated by Firefox.'),\n};\n\nexport const DEPRECATED_CHROME_API = {\n  // We are re-using the same code here for consistency and for technical\n  // reasons. We aren't really able to issue different codes from the same\n  // rule, so until we have to, we're going to re-use the `DEPRECATED_API`\n  // code.\n  // Because of that implementation detail ``description`` isn't being usable\n  // too.\n  code: 'DEPRECATED_API',\n  message: null,\n  messageFormat: i18n._('\"{{api}}\" is deprecated or unimplemented'),\n  description: null,\n};\n\nfunction temporaryAPI(api) {\n  return {\n    code: apiToMessage(api),\n    message: i18n._(`\"${api}\" can cause issues when loaded temporarily`),\n    description: i18n._(oneLine`This API can cause issues when loaded\n      temporarily using about:debugging in Firefox unless you specify\n      applications|browser_specific_settings > gecko > id in the manifest.\n      Please see: https://mzl.la/2hizK4a for more.`),\n  };\n}\n\nexport const STORAGE_SYNC = temporaryAPI('storage.sync');\nexport const IDENTITY_GETREDIRECTURL = temporaryAPI('identity.getRedirectURL');\nexport const STORAGE_MANAGED = temporaryAPI('storage.managed');\nexport const RUNTIME_ONMESSAGEEXTERNAL = temporaryAPI(\n  'runtime.onMessageExternal'\n);\nexport const RUNTIME_ONCONNECTEXTERNAL = temporaryAPI(\n  'runtime.onConnectExternal'\n);\n\nexport const INCOMPATIBLE_API = {\n  code: 'INCOMPATIBLE_API',\n  message: null,\n  messageFormat: i18n._(\n    '{{api}} is not supported in Firefox version {{minVersion}}'\n  ),\n  description: i18n._(\n    'This API is not implemented by the given minimum Firefox version'\n  ),\n};\n\nexport const ANDROID_INCOMPATIBLE_API = {\n  code: 'ANDROID_INCOMPATIBLE_API',\n  message: null,\n  messageFormat: i18n._(\n    '{{api}} is not supported in Firefox for Android version {{minVersion}}'\n  ),\n  description: i18n._(\n    'This API is not implemented by the given minimum Firefox for Android version'\n  ),\n};\n\nexport const ESLINT_OVERWRITE_MESSAGE = {\n  'no-eval': DANGEROUS_EVAL,\n  'no-implied-eval': NO_IMPLIED_EVAL,\n  'no-new-func': DANGEROUS_EVAL,\n  'no-unsanitized/property': UNSAFE_DYNAMIC_VARIABLE_ASSIGNMENT,\n  'no-unsanitized/method': UNSAFE_DYNAMIC_VARIABLE_ASSIGNMENT,\n  'webextension-unsupported-api': UNSUPPORTED_API,\n  'webextension-deprecated-api': DEPRECATED_API,\n  'webextension-api-compat': INCOMPATIBLE_API,\n  'webextension-api-compat-android': ANDROID_INCOMPATIBLE_API,\n};\n","module.exports = require(\"@mdn/browser-compat-data\");;","import { DEPRECATED_JAVASCRIPT_APIS, TEMPORARY_APIS } from 'const';\nimport schemaList from 'schema/imported';\n\nconst schemaArrayNames = ['functions', 'events'];\nconst schemaObjectNames = ['types', 'properties'];\nconst schemas = schemaList.reduce(\n  (all, current) => ({\n    ...all,\n    [current.id]: current,\n  }),\n  {}\n);\n\nfunction getObjectProperty(schema, property) {\n  for (const schemaProperty of schemaObjectNames) {\n    if (\n      schema &&\n      schema[schemaProperty] &&\n      property in schema[schemaProperty]\n    ) {\n      return schema[schemaProperty][property];\n    }\n  }\n  return null;\n}\n\nfunction getArrayProperty(schema, property) {\n  for (const schemaProperty of schemaArrayNames) {\n    if (schema && schemaProperty in schema) {\n      const namespaceProperties = schema[schemaProperty];\n      if (Array.isArray(namespaceProperties)) {\n        for (const schemaItem of namespaceProperties) {\n          if (schemaItem.name === property) {\n            return schemaItem;\n          }\n        }\n      }\n    }\n  }\n  return null;\n}\n\nexport function isTemporaryApi(namespace, property) {\n  return TEMPORARY_APIS.includes(`${namespace}.${property}`);\n}\n\nexport function isDeprecatedApi(namespace, property) {\n  const schema = schemas[namespace];\n\n  const schemaItem =\n    getObjectProperty(schema, property) || getArrayProperty(schema, property);\n\n  return (\n    (schemaItem !== null && schemaItem.deprecated !== undefined) ||\n    Object.prototype.hasOwnProperty.call(\n      DEPRECATED_JAVASCRIPT_APIS,\n      `${namespace}.${property}`\n    )\n  );\n}\n\nexport function hasBrowserApi(namespace, property) {\n  const schema = schemas[namespace];\n  // We \"have\" the API if it's deprecated or temporary so we don't double warn.\n  if (\n    isTemporaryApi(namespace, property) ||\n    isDeprecatedApi(namespace, property)\n  ) {\n    return true;\n  }\n\n  const schemaItem =\n    getObjectProperty(schema, property) || getArrayProperty(schema, property);\n\n  return schemaItem && !schemaItem.unsupported;\n}\n","// This file is generated by the schema import script.\n\nimport activityLog from './activity_log.json';\nimport alarms from './alarms.json';\nimport bookmarks from './bookmarks.json';\nimport browserAction from './browser_action.json';\nimport browserSettings from './browser_settings.json';\nimport browsingData from './browsing_data.json';\nimport captivePortal from './captive_portal.json';\nimport chrome_settings_overrides from './chrome_settings_overrides.json';\nimport clipboard from './clipboard.json';\nimport commands from './commands.json';\nimport contentScripts from './content_scripts.json';\nimport contextualIdentities from './contextual_identities.json';\nimport cookies from './cookies.json';\nimport devtools from './devtools.json';\nimport dns from './dns.json';\nimport downloads from './downloads.json';\nimport events from './events.json';\nimport experiments from './experiments.json';\nimport extension from './extension.json';\nimport extension_protocol_handlers from './extension_protocol_handlers.json';\nimport extensionTypes from './extension_types.json';\nimport find from './find.json';\nimport geckoProfiler from './geckoProfiler.json';\nimport history from './history.json';\nimport i18n from './i18n.json';\nimport identity from './identity.json';\nimport idle from './idle.json';\nimport management from './management.json';\nimport menus from './menus.json';\nimport native_manifest from './native_manifest.json';\nimport networkStatus from './network_status.json';\nimport normandyAddonStudy from './normandyAddonStudy.json';\nimport notifications from './notifications.json';\nimport omnibox from './omnibox.json';\nimport pageAction from './page_action.json';\nimport permissions from './permissions.json';\nimport pkcs11 from './pkcs11.json';\nimport privacy from './privacy.json';\nimport proxy from './proxy.json';\nimport runtime from './runtime.json';\nimport search from './search.json';\nimport sessions from './sessions.json';\nimport sidebarAction from './sidebar_action.json';\nimport storage from './storage.json';\nimport tabs from './tabs.json';\nimport telemetry from './telemetry.json';\nimport test from './test.json';\nimport theme from './theme.json';\nimport topSites from './top_sites.json';\nimport types from './types.json';\nimport url_overrides from './url_overrides.json';\nimport urlbar from './urlbar.json';\nimport userScripts from './userScripts.json';\nimport webNavigation from './web_navigation.json';\nimport webRequest from './web_request.json';\nimport windows from './windows.json';\nimport contextMenus from './context_menus.json';\nexport default [\n  activityLog,\n  alarms,\n  bookmarks,\n  browserAction,\n  browserSettings,\n  browsingData,\n  captivePortal,\n  chrome_settings_overrides,\n  clipboard,\n  commands,\n  contentScripts,\n  contextualIdentities,\n  cookies,\n  devtools,\n  dns,\n  downloads,\n  events,\n  experiments,\n  extension,\n  extension_protocol_handlers,\n  extensionTypes,\n  find,\n  geckoProfiler,\n  history,\n  i18n,\n  identity,\n  idle,\n  management,\n  menus,\n  native_manifest,\n  networkStatus,\n  normandyAddonStudy,\n  notifications,\n  omnibox,\n  pageAction,\n  permissions,\n  pkcs11,\n  privacy,\n  proxy,\n  runtime,\n  search,\n  sessions,\n  sidebarAction,\n  storage,\n  tabs,\n  telemetry,\n  test,\n  theme,\n  topSites,\n  types,\n  url_overrides,\n  urlbar,\n  userScripts,\n  webNavigation,\n  webRequest,\n  windows,\n  contextMenus,\n];\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","import bcd from '@mdn/browser-compat-data';\n\nimport { ANDROID_INCOMPATIBLE_API } from 'messages/javascript';\nimport { createCompatibilityRule } from 'utils';\nimport { hasBrowserApi } from 'schema/browser-apis';\n\nconst rule = {\n  create(context) {\n    return createCompatibilityRule(\n      'firefox_android',\n      ANDROID_INCOMPATIBLE_API,\n      context,\n      bcd,\n      hasBrowserApi\n    );\n  },\n};\n\nexport default rule;\nexport const { create } = rule;\n"],"sourceRoot":""}